(self.webpackChunkdocusaurus_template=self.webpackChunkdocusaurus_template||[]).push([[2480],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),m=r,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||i;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},972:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return c},default:function(){return u}});var a=n(22122),r=n(19756),i=(n(67294),n(3905)),o=["components"],s={id:"redirects",title:"Browser Redirects and Flow Completion"},l=void 0,p={unversionedId:"concepts/redirects",id:"concepts/redirects",isDocsHomePage:!1,title:"Browser Redirects and Flow Completion",description:"Ory Cloud offers a few methods to integrate your own user interface (UI) such as",source:"@site/docs/concepts/redirects.mdx",sourceDirName:"concepts",slug:"/concepts/redirects",permalink:"/docs/concepts/redirects",editUrl:"https://github.com/ory/docs/edit/master/docs/docs/concepts/redirects.mdx",tags:[],version:"current",lastUpdatedBy:"Alano Terblanche",lastUpdatedAt:1631623273,formattedLastUpdatedAt:"9/14/2021",frontMatter:{id:"redirects",title:"Browser Redirects and Flow Completion"},sidebar:"docs",previous:{title:"Self-Service (End-User)",permalink:"/docs/concepts/self-service"},next:{title:"Sessions",permalink:"/docs/concepts/session"}},c=[{value:"Allow list",id:"allow-list",children:[],level:2},{value:"Redirect Flows",id:"redirect-flows",children:[{value:"Login, Registration and Settings",id:"login-registration-and-settings",children:[],level:3},{value:"Verification, Recovery and Logout",id:"verification-recovery-and-logout",children:[],level:3}],level:2},{value:"Resetting/Updating Flows",id:"resettingupdating-flows",children:[],level:2},{value:"Troubleshooting Guide",id:"troubleshooting-guide",children:[{value:"Allow List",id:"allow-list-1",children:[],level:3},{value:"Post Flow",id:"post-flow",children:[],level:3},{value:"Domain Denied",id:"domain-denied",children:[],level:3}],level:2}],d={toc:c};function u(e){var t=e.components,s=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Ory Cloud offers a few methods to integrate your own user interface (UI) such as\nutilising the SDK in Single Page Applications (ReactJs, Angular, VueJs etc.) or\nusing redirects in Server Side Applications (NodeJs, PHP, Golang etc.)."),(0,i.kt)("p",null,"On this page of the documentation we will be covering Browser Redirects and how\nto configure it on the Ory Cloud console. If you are interested in utilising the\nSDK for Single Page Applications, check out our ",(0,i.kt)("a",{parentName:"p",href:"/docs/concepts/services-api"},"SDK"),"\ndocumentation."),(0,i.kt)("p",null,"For a deeper dive into the background of this setup, head over to our open\nsource documentation:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.ory.sh/kratos/docs/concepts/browser-redirect-flow-completion"},"https://www.ory.sh/kratos/docs/concepts/browser-redirect-flow-completion"))),(0,i.kt)("h2",{id:"allow-list"},"Allow list"),(0,i.kt)("p",null,"The Ory Cloud allows dynamic redirects to be set using the ",(0,i.kt)("inlineCode",{parentName:"p"},"?return_to=")," query\nparameter on ",(0,i.kt)("a",{parentName:"p",href:"/docs/concepts/self-service"},"Self-Service Flows"),". As an example a user\nopens a sharable link to go to ",(0,i.kt)("a",{parentName:"p",href:"https://myapp.com/posts"},"https://myapp.com/posts"),", however, this url\nrequires the user to be signed in and thus redirects the user back to the login\npage. To return the user back to the original url we can append\n",(0,i.kt)("inlineCode",{parentName:"p"},"?return_to=https://myapp.com/posts")," to the specified Self-Service initialise\nflow url."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Allow list")," is used in this scenario to prevent Open Redirect Attacks by\nonly allowing certain domains, or paths on a domain. As shown in this example\nbelow the ",(0,i.kt)("a",{parentName:"p",href:"https://sub.domain.myapp.com/only/path"},"https://sub.domain.myapp.com/only/path")," needs to match perfectly for\nthis sub-domain and path for it to be allowed. Other redirects using myapp.com\nwill fail, however, for ",(0,i.kt)("a",{parentName:"p",href:"https://anotherapp.com"},"https://anotherapp.com")," will succeed on any path."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects Allow List",src:n(84549).Z})),(0,i.kt)("h2",{id:"redirect-flows"},"Redirect Flows"),(0,i.kt)("p",null,"The Ory Cloud has a total of 6 flows, Login, Registration, Verification,\nRecovery, Settings and Logout which can be configured to redirect back to any\nURL you specify. As an example you can redirect the user to your application\nhome screen after a logout or to a specific url on a sub-domain after a settings\npassword update. On project creation the redirect flows are all set to the\ndefault Ory Cloud Managed UI. For more information on the Ory Managed UI, please\nsee the ",(0,i.kt)("a",{parentName:"p",href:"/docs/concepts/managed-ui"},"Managed User Interface")," documentation."),(0,i.kt)("h3",{id:"login-registration-and-settings"},"Login, Registration and Settings"),(0,i.kt)("p",null,"The Login and Registration flows have three fields (all optional):"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"Default Redirect URL")," domain or path relative to your application URL"),(0,i.kt)("li",{parentName:"ol"},"An ",(0,i.kt)("inlineCode",{parentName:"li"},"Post-Password Redirect URL")),(0,i.kt)("li",{parentName:"ol"},"An ",(0,i.kt)("inlineCode",{parentName:"li"},"Post-OIDC Redirect URL")," (",(0,i.kt)("strong",{parentName:"li"},"currently not supported"),")")),(0,i.kt)("p",null,"And Settings has three fields (all optional):"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"Default Redirect URL")," domain or path relative to your application URL"),(0,i.kt)("li",{parentName:"ol"},"An ",(0,i.kt)("inlineCode",{parentName:"li"},"Post-Password Redirect URL")),(0,i.kt)("li",{parentName:"ol"},"An ",(0,i.kt)("inlineCode",{parentName:"li"},"Post-Profile Redirect URL"))),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Setting ",(0,i.kt)("inlineCode",{parentName:"p"},"Post-OIDC")," redirects for Login and Registration are currently not\nsupported since an Ory Cloud project cannot be setup to use OIDC yet. This will\nbe supported in the future. For more information see the\n",(0,i.kt)("a",{parentName:"p",href:"/docs/early-access"},"Ory Cloud Roadmap"),"."))),(0,i.kt)("p",null,"When setting the ",(0,i.kt)("inlineCode",{parentName:"p"},"Default Redirect URL")," as an FQDN (fully qualified domain name)\nsuch as e.g. ",(0,i.kt)("a",{parentName:"p",href:"https://domain.example/login"},"https://domain.example/login")," it will overwrite the\n",(0,i.kt)("inlineCode",{parentName:"p"},"Global Redirect URL"),". As a path it will replace the ",(0,i.kt)("inlineCode",{parentName:"p"},"Global Redirect URL")," path,\ne.g. a path such as ",(0,i.kt)("inlineCode",{parentName:"p"},"/login")," will alter ",(0,i.kt)("a",{parentName:"p",href:"https://domain.example/global/path"},"https://domain.example/global/path")," to\n",(0,i.kt)("a",{parentName:"p",href:"https://domain.example/login"},"https://domain.example/login"),"."),(0,i.kt)("p",null,"On the sub-conditions such as ",(0,i.kt)("inlineCode",{parentName:"p"},"Post-Password")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"Post-OIDC")," an FQDN or a path\ncan be set. In the case of an FQDN it will replace the closest relative starting\nwith the Login/Registration ",(0,i.kt)("inlineCode",{parentName:"p"},"Default Redirect URL")," and then the\n",(0,i.kt)("inlineCode",{parentName:"p"},"Global Redirect URL"),". With a path it will use the closest relative as the base\nURL as described above with the ",(0,i.kt)("inlineCode",{parentName:"p"},"Default Redirect URL"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects Url Management",src:n(22223).Z})),(0,i.kt)("p",null,"All the relative URLs will be updated with their respective base URL. As shown\nin the example below, the Login ",(0,i.kt)("inlineCode",{parentName:"p"},"Default Redirect URL")," has been set to use a\nrelative URL and thus the base URL will be the ",(0,i.kt)("inlineCode",{parentName:"p"},"Global Redirect URL"),"\n(",(0,i.kt)("a",{parentName:"p",href:"https://myapp.com"},"https://myapp.com"),"). This will then set the Login ",(0,i.kt)("inlineCode",{parentName:"p"},"Default Redirect URL")," to\n",(0,i.kt)("a",{parentName:"p",href:"https://myapp.com/after/login"},"https://myapp.com/after/login")," and the ",(0,i.kt)("inlineCode",{parentName:"p"},"Post-Password")," to\n",(0,i.kt)("a",{parentName:"p",href:"https://myapp.com/after/login/password"},"https://myapp.com/after/login/password"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects URL Management Transformed",src:n(18075).Z})),(0,i.kt)("h3",{id:"verification-recovery-and-logout"},"Verification, Recovery and Logout"),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Post-Recovery")," redirect is currently not supported and will automatically\nredirect the user to the ",(0,i.kt)("inlineCode",{parentName:"p"},"Settings UI")," URL. This implies that you should\ncurrently rely on the ",(0,i.kt)("inlineCode",{parentName:"p"},"Post-Settings")," redirect URL for ",(0,i.kt)("inlineCode",{parentName:"p"},"Post-Recovery")," flows as\nwell."))),(0,i.kt)("p",null,"Each of these flows have only a single field, the ",(0,i.kt)("inlineCode",{parentName:"p"},"Default Redirect URL"),". As\nwith the Login, Registration and Settings configurations, the\n",(0,i.kt)("inlineCode",{parentName:"p"},"Default Redirect URL")," can be an FQDN or a path."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects URL Management Transformed",src:n(62695).Z})),(0,i.kt)("h2",{id:"resettingupdating-flows"},"Resetting/Updating Flows"),(0,i.kt)("p",null,'A redirect can easily be updated or reset by either changing the current\nredirects value or deleting the entry and clicking the "Update" button. All the\nflows can be reset at once by pressing the "Reset Flows" button which will\nprompt a confirmation box. Resetting all flows will reset all the fields back to\nthe default value which is the Ory Cloud\n',(0,i.kt)("a",{parentName:"p",href:"/docs/concepts/managed-ui"},"Managed User Interface"),"."),(0,i.kt)("p",null,"Once a flow has been reset or updated it will take effect immediately on ",(0,i.kt)("strong",{parentName:"p"},"new"),"\nflows. Old flows that have not expired yet will not be updated."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects URL Reset All",src:n(52288).Z})),(0,i.kt)("h2",{id:"troubleshooting-guide"},"Troubleshooting Guide"),(0,i.kt)("h3",{id:"allow-list-1"},"Allow List"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Allow List")," requires a valid URL to be set with a scheme (http or https)."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects URL Error Message",src:n(64724).Z})),(0,i.kt)("h3",{id:"post-flow"},"Post Flow"),(0,i.kt)("p",null,"Any of the Post-flow redirects require a valid URL with scheme (http or https)\nor path. An example of a valid URL is ",(0,i.kt)("a",{parentName:"p",href:"https://www.google.com"},"https://www.google.com"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects URL Error Message Flows",src:n(80233).Z})),(0,i.kt)("h3",{id:"domain-denied"},"Domain Denied"),(0,i.kt)("p",null,"URLs matching any of the denied URLs, such as the Ory domain will automatically\nbe denied. This deny list can be extended in future to prevent any abuse on the\nOry Cloud."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Browser Redirects URL Error Message",src:n(10121).Z})))}u.isMDXComponent=!0},84549:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-allow-list-57d1370f1abfbe0d73e1657a85aea343.png"},64724:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-error-messages-1-2d248ce9d48a5662bf7e79f24c37baa2.png"},10121:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-error-messages-2-8fade8e20295df353a137e9c44e0a930.png"},80233:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-error-messages-flows-67e54f6d9b9a3a9485bb55441f67496d.png"},52288:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-reset-all-457b9f7888687b313a8cf2003095a58a.png"},18075:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-url-management-2-11209eb9b9b61e2d471a26260cdcc3cd.png"},62695:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-url-management-3-79a0ef191b4fed77e959cfa480a3d6f8.png"},22223:function(e,t,n){"use strict";t.Z=n.p+"assets/images/browser-redirects-url-management-f7789424423a460b6ff4288397a34ce5.png"}}]);