<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["setCookieDomain","*.ory.sh"]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="//sqa-web.ory.sh/";_paq.push(["setTrackerUrl",e+"np.php"]),_paq.push(["setSiteId","2"]);var a=document,p=a.createElement("script"),t=a.getElementsByTagName("script")[0];p.type="text/javascript",p.async=!0,p.src=e+"js/np.min.js",t.parentNode.insertBefore(p,t)}()</script>
<link rel="search" type="application/opensearchdescription+xml" title="Ory Kratos" href="/kratos/docs/opensearch.xml"><title data-react-helmet="true">Threat Models and Security Profiles | Ory Kratos</title><meta data-react-helmet="true" property="og:url" content="https://www.ory.sh//kratos/docs/next/concepts/security"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Threat Models and Security Profiles | Ory Kratos"><meta data-react-helmet="true" name="description" content="Please be aware that this chapter is still work in progress. Not all mitigation"><meta data-react-helmet="true" property="og:description" content="Please be aware that this chapter is still work in progress. Not all mitigation"><link data-react-helmet="true" rel="shortcut icon" href="/kratos/docs/img/favico.png"><link data-react-helmet="true" rel="canonical" href="https://www.ory.sh//kratos/docs/next/concepts/security"><link data-react-helmet="true" rel="alternate" href="https://www.ory.sh//kratos/docs/next/concepts/security" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.ory.sh//kratos/docs/next/concepts/security" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/kratos/docs/assets/css/styles.5db2420e.css">
<link rel="preload" href="/kratos/docs/assets/js/runtime~main.2e233c13.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/main.4879151c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div id="route-identifier" data-route="/kratos/docs/next/concepts/security"><div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" role="banner"><div class="announcementBarContent_3EUC announcementBarCloseable_3myR">Sign up for <a href="https://ory.us10.list-manage.com/subscribe?u=ffb1a878e4ec6c0ed312a3480&id=f605a41b53&group[17097][4]=1">important security announcements</a> and if you like Ory Kratos give it a ‚≠êÔ∏è on <a target="_blank" rel="noopener noreferrer" href="https://github.com/ory/kratos">GitHub</a>!</div><button type="button" class="announcementBarClose_38nx clean-btn" aria-label="Close"><span aria-hidden="true">√ó</span></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a href="https://www.ory.sh/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Home</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ory/kratos/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/kratos/docs/next/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/kratos/docs/next/concepts/security">Next</a></li><li><a class="dropdown__link" href="/kratos/docs/concepts/security">v0.7</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.6/concepts/security">v0.6</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.5/concepts/security">v0.5</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.4/concepts/security">v0.4</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.3/concepts/security">v0.3</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.2/concepts/security">v0.2</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.1/concepts/security">v0.1</a></li><li><a class="dropdown__link" href="/kratos/docs/versions">All versions</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/docs/" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Welcome to Ory!<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs/get-started" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Become an Ory Insider<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs/early-access" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Ory Cloud Roadmap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Start Building</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guides</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs/reference/api" target="_blank" rel="noopener noreferrer" class="menu__link"><span>HTTP API Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Open Source Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Open Source Ory Kratos</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/terminology">Terminology</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/ui-user-interface">User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/identity-schema">Identity Schema</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Identity Credentials</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/browser-redirect-flow-completion">HTTP Redirection Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/rest-api">REST API Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/federation">Federation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kratos/docs/next/concepts/security">Threat Models and Security Profiles</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Self Service (End-User)</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Administration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Guides</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/reference/api">HTTP API</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Reference</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Debug &amp; Help</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">SDKs</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Development</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Further Reading</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Open Source Ory Keto</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Open Source Ory Hydra</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Open Source Ory Oathkeeper</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Ory Kratos <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/kratos/docs/concepts/security">latest version</a></b> (v0.7).</div></div><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: Next</span><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Threat Models and Security Profiles</h1></header><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Please be aware that this chapter is still work in progress. Not all mitigation
strategies have been implemented yet in Ory Kratos!</p></div></div><p>Running any software that stores personal information exposes the
developer/company to risks. Analyzing which threat agents pose a risk,
understanding the possible motivations for an attack, or why an agent is a
threat, knowing the attack surface, the likelihood, and the impact are important
all aspects of a threat model.</p><p>This documentation can not substitute a thorough and serious threat model, yet
it will provide some guidelines to help configure Ory Kratos in a way that makes
it best suited for any risk assessment.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="account-enumeration-attacks"></a>Account Enumeration Attacks<a class="hash-link" href="#account-enumeration-attacks" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/133" target="_blank" rel="noopener noreferrer">kratos#133</a>.</p><p>It does not yet work as documented!</p></div></div><blockquote><p>&quot;Often, web applications reveal when a username exists on system, either as a
consequence of a misconfiguration or as a design decision. For example,
sometimes, when we submit wrong credentials, we receive a message that states
that either the username is present on the system or the provided password is
wrong. The information obtained can be used by an attacker to gain a list of
users on system. This information can be used to attack the web application,
for example, through a brute force or default username/password attack.
Description of the Issue&quot;</p><p><a href="https://wiki.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)" target="_blank" rel="noopener noreferrer">Source</a></p></blockquote><p>Considering the above, an example would be for example an adult website. A
threat agent wants to blackmail a well known politician by checking if someone
can sign up at that website using the <code>well-known-politician@email.com</code> email.</p><p>If the service responds with
<code>Sorry, that email is already signed up here. Did you try to log in instead?</code>,
the agent is able to proceed with some type of blackmail scheme.</p><p><a href="https://wiki.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)#Black_Box_testing_and_example" target="_blank" rel="noopener noreferrer">OWASP defines several Black-Box tests</a>
that cover Account Enumeration Scenarios.</p><p>This attack usually makes only sense if an email address or a phone number is
collected during registration. For chosen usernames, this attack is much more
difficult, as the attacker has to know what usernames the victim is using.</p><p>There are three common ways an attacker can figure out if a user is signed up at
a service:</p><ul><li>During login: &quot;No user with this email address was found&quot;</li><li>During registration or email update: &quot;A user with this email address exists
already&quot;</li><li>During password reset: &quot;No user with this email address was found&quot;</li></ul><p>To mitigate this attack, the following methods need to be deployed:</p><ul><li>The login form should return the same message regardless of whether the
password is wrong or the email/username does not exist: &quot;The provided
credentials are invalid.&quot;</li><li>The password reset form should always return a success message and send out an
email. If the email address is registered, a normal password reset email is
sent. If the email address is not registered, an email is sent to the address
indicating that no account is set up with that email address. This is helpful
to users that have multiple email addresses and are using the wrong email
address for the password reset.</li><li>The registration form should also always return a success message and send out
an email. If the email address is not yet registered, a regular &quot;account
activation&quot; email is sent out. If the email address is registered already, a
email is sent out telling the user that the account is already set up, and
link to the login screen.</li></ul><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>If you wish to mitigate account enumeration attacks, it is important to note
that you cannot sign in users directly after sign up! Depending on the type of
service you provide, you might not care about this specific attack in which case
direct login after sign up would be ok.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hash-timing-attack-mitigation"></a>Hash Timing Attack Mitigation<a class="hash-link" href="#hash-timing-attack-mitigation" title="Direct link to heading">#</a></h3><p>A timing attack against password hashing looks as follows:</p><ol><li>Login to an existing account and measure time which takes, depending on the
hashing configuration, between 200ms and 2s;0</li><li>Try out other accounts (e.g. <code>alice@example.org</code>). If the account does not
exist, password hashing does not run, hence it takes much less time for the
server to answer (&lt; 100ms).</li></ol><p>To protect against this attack, Ory Kratos adds a configurable delay with
standard deviation to login flows where the account does not exist.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="enabling-account-enumeration-defenses"></a>Enabling Account Enumeration Defenses<a class="hash-link" href="#enabling-account-enumeration-defenses" title="Direct link to heading">#</a></h3><p>Assuming you wish to enable account enumeration defenses, you need to configure
Ory Kratos as follows:</p><ul><li>Collect one or more email addresses during sign up and enable email
verification.</li><li><strong>Do not</strong> enable the <code>session</code> post-registration workflow.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">flows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">verification</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defending-against-account-enumeration-when-using-openid-connect"></a>Defending Against Account Enumeration when using OpenID Connect<a class="hash-link" href="#defending-against-account-enumeration-when-using-openid-connect" title="Direct link to heading">#</a></h4><p>Scenario: In some cases you might want to use the email address returned by e.g.
the GitHub profile to be added to your identity&#x27;s account. You might also want
to use it as an email + password identifier so that the identity is able to log
in with a password as well. An attacker is able to exploit that by creating a
social profile on another site (e.g. Google) and use the victims email address
to set it up (this only works when the victim does not yet have an account with
that email at Google). The attacker can then use that &quot;spoofed&quot; social profile
to try and sign up with your Ory Kratos installation. Because the victim&#x27;s email
address is already known to Ory Kratos, the attacker might be able to observe
the behavior (e.g. seeing an error page) and come to the conclusion that the
victim already has an account at the website.</p><p>Mitigation: This attack surface is rather small and requires a lot of effort,
including forging an e.g. Google profile, and can fail at several stages. To
completely mitigate any chance of that happening, only accept email addresses
that are marked as verified in your Jsonnet code:</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">contrib/quickstart/kratos/email-password/oidc.github.jsonnet</div><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">local claims = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  email_verified</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Therefore we only return the email if it (a) exists and (b) is marked verified</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// by GitHub.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email_primary&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email_primary</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="disabling-account-enumeration-defenses"></a>Disabling Account Enumeration Defenses<a class="hash-link" href="#disabling-account-enumeration-defenses" title="Direct link to heading">#</a></h3><p>Enforcing email verification, which requires an email round trip and disrupts
the sign up process, is not always feasible. In these cases, you might want to
disable account enumeration defenses.</p><p>If you enable the <code>session</code> post-registration workflow - signing the user in
directly after registration - disables account enumeration defenses:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">flows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">registration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">after</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">hook</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="account-takeover-defenses"></a>Account Takeover Defenses<a class="hash-link" href="#account-takeover-defenses" title="Direct link to heading">#</a></h2><p>The Settings Flow implements account takeover defenses as it is not possible to
change the password without knowing the existing password. A good example of
this flow is the
<a href="https://help.github.com/en/github/authenticating-to-github/sudo-mode" target="_blank" rel="noopener noreferrer">GitHub sudo mode</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="passwords"></a>Passwords<a class="hash-link" href="#passwords" title="Direct link to heading">#</a></h2><p>Password-based authentication flows are subject to frequent abuse through</p><ul><li>Social Engineering Attacks;</li><li>Password Guessing Attacks;</li><li>Phishing Attacks.</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Further improvements are work in progress and are tracked on
<a href="https://github.com/ory/kratos/issues?q=is%3Aopen+label%3Amodule%3Ass%2Fpassword+" target="_blank" rel="noopener noreferrer">GitHub</a></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="expensive-hashing-with-bcrypt"></a>Expensive Hashing with BCrypt<a class="hash-link" href="#expensive-hashing-with-bcrypt" title="Direct link to heading">#</a></h3><p>Ory Kratos supports BCrypt for password hashing per default. BCrypt is
recommended when you want hashing to take at most one second:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">hashers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">algorithm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bcrypt</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">bcrypt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cost</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="expensive-hashing-with-argon2"></a>Expensive Hashing with Argon2<a class="hash-link" href="#expensive-hashing-with-argon2" title="Direct link to heading">#</a></h3><p>Ory Kratos supports Argon2 for password hashing. Argon2 is recommended when you
want hashing to take at least 2 seconds. You can tweak the Argon2 configuration
in your Ory Kratos configuration file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">hashers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">algorithm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argon2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">argon2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 128MB</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">iterations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">parallelism</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">salt_length</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">key_length</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To determine the ideal parameters, head over to the
<a href="/kratos/docs/next/guides/setting-up-password-hashing-parameters">setup guide</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="password-policy"></a>Password Policy<a class="hash-link" href="#password-policy" title="Direct link to heading">#</a></h3><p>To prevent weak passwords Ory Kratos implements different measures. Users often
choose passwords similar to their traits. To prevent this Ory Kratos ensures
there is a sufficient
<a href="https://en.wikipedia.org/wiki/Levenshtein_distance" target="_blank" rel="noopener noreferrer">Levenshtein-Distance</a> (aka
&quot;Edit-Distance&quot;) between the identifier and the password. It also makes sure
that the identifier and password have a small enough longest common substring.</p><p>Furthermore the <code>password</code> method comes with a build-in check against the
<a href="https://haveibeenpwned.com" target="_blank" rel="noopener noreferrer">&quot;Have I been pwned&quot;</a> breach database. This way Ory
Kratos makes sure your users cannot use passwords like &quot;password&quot;, &quot;123456&quot; or
any other commonly used one. To protect the value of the password the
<a href="https://haveibeenpwned.com/API/v3#SearchingPwnedPasswordsByRange" target="_blank" rel="noopener noreferrer">range API</a> is
being used.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="password-policy-best-practices"></a>Password Policy Best Practices<a class="hash-link" href="#password-policy-best-practices" title="Direct link to heading">#</a></h4><p>Almost every service with a login offers some type of registration using a
password. Therefore, there are many strategies floating around, with many of
them implementing terrible and insecure patterns such as:</p><ul><li>Not allowing special characters in passwords.</li><li>Not allowing the use of password managers by disabling the &quot;paste&quot;
functionality in password fields.</li><li>Requiring you to rotate your password every month (passwords expire).</li><li>...</li></ul><p>Troy Hunt has written an
<a href="https://www.troyhunt.com/passwords-evolved-authentication-guidance-for-the-modern-era/" target="_blank" rel="noopener noreferrer">excellent piece on password policies</a>
and why they recently changed and how.</p><p>Ory Kratos implements a password policy that:</p><ul><li>Checks if a password has previously been leaked using the
<a href="https://haveibeenpwned.com/API/v2" target="_blank" rel="noopener noreferrer">HIBP API</a>,</li><li>Checks if a password is too similar to one of the identifiers (in a future
release <a href="https://github.com/ory/kratos/issues/184" target="_blank" rel="noopener noreferrer">kratos#184</a>),</li><li>Makes passwords not expire.</li></ul><p>This is a rundown of all the practices Ory Kratos implements and why. <strong>Some
things need to be implemented by yourself</strong> as they must be implemented in the
User Interface that interfaces with Ory Kratos. You can find these in section
<a href="#user-interface-guidelines">User Interface Guidelines</a>.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="password-complexity"></a>Password Complexity<a class="hash-link" href="#password-complexity" title="Direct link to heading">#</a></h5><p>This outline and quotes are defined in the
<a href="https://pages.nist.gov/800-63-3/sp800-63b.html" target="_blank" rel="noopener noreferrer">NIST Digital Identity Guidelines - 5.1.1.2 Memorized Secret Verifiers</a>.
Ory Kratos, unless explicitly advertised, implements these guidelines and best
practices.</p><p>Passwords must have a minimum length of 8 characters and all characters
(unicode, ASCII) must be allowed:</p><blockquote><p>Verifiers SHALL require subscriber-chosen memorized secrets to be at least 8
characters in length. Verifiers SHOULD permit subscriber-chosen memorized
secrets at least 64 characters in length. All printing ASCII [RFC 20]
characters as well as the space character SHOULD be acceptable in memorized
secrets. Unicode [ISO/ISC 10646] characters SHOULD be accepted as well. To
make allowances for likely mistyping, verifiers MAY replace multiple
consecutive space characters with a single space character prior to
verification, provided that the result is at least 8 characters in length.
Truncation of the secret SHALL NOT be performed. For purposes of the above
length requirements, each Unicode code point SHALL be counted as a single
character.</p></blockquote><p>Passwords must be checked against a database of compromised secrets such as
<a href="https://haveibeenpwned.com" target="_blank" rel="noopener noreferrer">Have I Been Pwnd</a>:</p><blockquote><p>When processing requests to establish and change memorized secrets, verifiers
SHALL compare the prospective secrets against a list that contains values
known to be commonly-used, expected, or compromised. For example, the list MAY
include, but is not limited to:</p><ul><li>Passwords obtained from previous breach corpuses.</li><li>Dictionary words.</li><li>Repetitive or sequential characters (e.g. ‚Äòaaaaaa‚Äô, ‚Äò1234abcd‚Äô).</li><li>Context-specific words, such as the name of the service, the username, and
derivatives thereof.</li></ul><p>If the chosen secret is found in the list, the CSP or verifier SHALL advise
the subscriber that they need to select a different secret, SHALL provide the
reason for rejection, and SHALL require the subscriber to choose a different
value.</p></blockquote><p>Show the user a password-strength meter (to be implemented, see
<a href="https://github.com/ory/kratos/issues/136" target="_blank" rel="noopener noreferrer">#136</a>):</p><blockquote><p>Verifiers SHOULD offer guidance to the subscriber, such as a password-strength
meter [Meters], to assist the user in choosing a strong memorized secret. This
is particularly important following the rejection of a memorized secret on the
above list as it discourages trivial modification of listed (and likely very
weak) memorized secrets</p></blockquote><p>Do not require mixtures of characters types or prohibiting repeated characters:</p><blockquote><p>Verifiers SHOULD NOT impose other composition rules (e.g., requiring mixtures
of different character types or prohibiting consecutively repeated characters)
for memorized secrets. Verifiers SHOULD NOT require memorized secrets to be
changed arbitrarily (e.g., periodically). However, verifiers SHALL force a
change if there is evidence of compromise of the authenticator.</p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="user-interface-guidelines"></a>User Interface Guidelines<a class="hash-link" href="#user-interface-guidelines" title="Direct link to heading">#</a></h5><p>These best practices need to be implemented in your User Interface and can not
be handled by Ory Kratos. All Ory-built reference and demo applications
implement these best practices:</p><p>Allow pasting of passwords:</p><blockquote><p>Verifiers SHOULD permit claimants to use ‚Äúpaste‚Äù functionality when entering a
memorized secret. This facilitates the use of password managers, which are
widely used and in many cases increase the likelihood that users will choose
stronger memorized secrets.</p></blockquote><p>Allow the user to show the secret in the UI:</p><blockquote><p>In order to assist the claimant in successfully entering a memorized secret,
the verifier SHOULD offer an option to display the secret ‚Äî rather than a
series of dots or asterisks ‚Äî until it is entered. This allows the claimant to
verify their entry if they are in a location where their screen is unlikely to
be observed. The verifier MAY also permit the user‚Äôs device to display
individual entered characters for a short time after each character is typed
to verify correct entry. This is particularly applicable on mobile devices.</p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="password-hints"></a>Password Hints<a class="hash-link" href="#password-hints" title="Direct link to heading">#</a></h5><blockquote><p>Memorized secret verifiers SHALL NOT permit the subscriber to store a ‚Äúhint‚Äù
that is accessible to an unauthenticated claimant.</p><p><a href="https://pages.nist.gov/800-63-3/sp800-63b.html" target="_blank" rel="noopener noreferrer">NIST Digital Identity Guidelines - 5.1.1.2 Memorized Secret Verifiers</a></p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="password-expiry"></a>Password Expiry<a class="hash-link" href="#password-expiry" title="Direct link to heading">#</a></h5><blockquote><p>Forcing password expiry carries no real benefits because:</p><ul><li>the user is likely to choose new passwords that are only minor variations of
the old</li><li>stolen passwords are generally exploited immediately</li><li>resetting the password gives you no information about whether a compromise
has occurred</li><li>an attacker with access to the account will probably also receive the
request to reset the password</li><li>if compromised via insecure storage, the attacker will be able to find the
new password in the same place</li></ul><p><a href="https://www.ncsc.gov.uk/collection/passwords/updating-your-approach" target="_blank" rel="noopener noreferrer">NSCS Password administration for system owners</a></p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="anti-automation"></a>Anti-Automation<a class="hash-link" href="#anti-automation" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/138" target="_blank" rel="noopener noreferrer">kratos#133</a>.</p></div></div><p>Actions that cause out-of-band communications, such as sending an activation
link via email or an activation code via SMS, can be abused by automated
systems. The goal of such an attack is to send out so many emails or SMS, that
your reputation worsens (spam filters) or you&#x27;re faced with massive costs
(carrier fees).</p><p>CAPTCHA renders these attacks either very difficult or impossible. Ory Kratos
has CAPTCHA support built-in. Ory Kratos will prompt the user to complete a
CAPTCHA in the following scenarios:</p><ul><li>The user tries to register more than one account within 72 hours.</li><li>The user failed provide valid credentials for the third time within 12 hours.</li><li>The user tries to recover their account for the second time within 72 hours.</li></ul><p>For integration guidelines, please check the individual flow&#x27;s (registration,
login, account recovery) integration documentation.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="bruteforce-attacks"></a>Bruteforce Attacks<a class="hash-link" href="#bruteforce-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="phishing-attacks"></a>Phishing Attacks<a class="hash-link" href="#phishing-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="social-engineering-attacks"></a>Social Engineering Attacks<a class="hash-link" href="#social-engineering-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="sms-spoofing-attacks"></a>SMS Spoofing Attacks<a class="hash-link" href="#sms-spoofing-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="account-enumeration"></a>Account Enumeration<a class="hash-link" href="#account-enumeration" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/133" target="_blank" rel="noopener noreferrer">kratos#133</a>.</p><p>It does not yet work as documented!</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="digital-identity-guidelines"></a>Digital Identity Guidelines<a class="hash-link" href="#digital-identity-guidelines" title="Direct link to heading">#</a></h2><p>There is no one standard to digital identity. Ory Kratos closely follows
emerging frameworks and guidelines such as:
<a href="https://pages.nist.gov/800-63-3/" target="_blank" rel="noopener noreferrer">Digital Identity Guidelines established by the National Institute of Standards and Technology (NIST)</a>
(and a follow-up <a href="https://pages.nist.gov/800-63-3/" target="_blank" rel="noopener noreferrer">FAQ</a>) .</p><p>As Ory Kratos grows, this document will continue to expand and add sections
covering individual security recommendations established by NIST.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/ory/kratos/edit/master/docs/docs/concepts/security.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-07-11T11:15:25.000Z">7/11/2021</time></b> by <b>aeneasr</b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kratos/docs/next/concepts/federation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Federation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kratos/docs/next/self-service"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Concepts and Overview ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#account-enumeration-attacks" class="table-of-contents__link">Account Enumeration Attacks</a><ul><li><a href="#hash-timing-attack-mitigation" class="table-of-contents__link">Hash Timing Attack Mitigation</a></li><li><a href="#enabling-account-enumeration-defenses" class="table-of-contents__link">Enabling Account Enumeration Defenses</a></li><li><a href="#disabling-account-enumeration-defenses" class="table-of-contents__link">Disabling Account Enumeration Defenses</a></li></ul></li><li><a href="#account-takeover-defenses" class="table-of-contents__link">Account Takeover Defenses</a></li><li><a href="#passwords" class="table-of-contents__link">Passwords</a><ul><li><a href="#expensive-hashing-with-bcrypt" class="table-of-contents__link">Expensive Hashing with BCrypt</a></li><li><a href="#expensive-hashing-with-argon2" class="table-of-contents__link">Expensive Hashing with Argon2</a></li><li><a href="#password-policy" class="table-of-contents__link">Password Policy</a></li></ul></li><li><a href="#anti-automation" class="table-of-contents__link">Anti-Automation</a></li><li><a href="#bruteforce-attacks" class="table-of-contents__link">Bruteforce Attacks</a></li><li><a href="#phishing-attacks" class="table-of-contents__link">Phishing Attacks</a></li><li><a href="#social-engineering-attacks" class="table-of-contents__link">Social Engineering Attacks</a></li><li><a href="#sms-spoofing-attacks" class="table-of-contents__link">SMS Spoofing Attacks</a></li><li><a href="#account-enumeration" class="table-of-contents__link">Account Enumeration</a></li><li><a href="#digital-identity-guidelines" class="table-of-contents__link">Digital Identity Guidelines</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.ory.sh/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.ory.sh/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://www.ory.sh/tos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div>Copyright ¬© 2021 ORY GmbH</div></div></div></footer></div></div>
<script src="/kratos/docs/assets/js/runtime~main.2e233c13.js"></script>
<script src="/kratos/docs/assets/js/main.4879151c.js"></script>
<noscript><p><img src="//sqa-web.ory.sh/np.php?idsite=2&amp;rec=1" style="border:0;" alt=""></p></noscript></body>
</html>