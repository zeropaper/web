<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["setCookieDomain","*.ory.sh"]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="//sqa-web.ory.sh/";_paq.push(["setTrackerUrl",e+"np.php"]),_paq.push(["setSiteId","2"]);var a=document,p=a.createElement("script"),t=a.getElementsByTagName("script")[0];p.type="text/javascript",p.async=!0,p.src=e+"js/np.js",t.parentNode.insertBefore(p,t)}()</script>
<link rel="search" type="application/opensearchdescription+xml" title="Ory Kratos" href="/kratos/docs/opensearch.xml"><title data-react-helmet="true">Threat Models and Security Profiles | Ory Kratos</title><meta data-react-helmet="true" property="og:url" content="https://www.ory.sh//kratos/docs/v0.2/concepts/security"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="v0.2"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-v0.2"><meta data-react-helmet="true" property="og:title" content="Threat Models and Security Profiles | Ory Kratos"><meta data-react-helmet="true" name="description" content="Running any software that stores personal information exposes the"><meta data-react-helmet="true" property="og:description" content="Running any software that stores personal information exposes the"><link data-react-helmet="true" rel="shortcut icon" href="/kratos/docs/img/favico.png"><link data-react-helmet="true" rel="canonical" href="https://www.ory.sh//kratos/docs/v0.2/concepts/security"><link data-react-helmet="true" rel="alternate" href="https://www.ory.sh//kratos/docs/v0.2/concepts/security" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.ory.sh//kratos/docs/v0.2/concepts/security" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/kratos/docs/assets/css/styles.d2c68386.css">
<link rel="preload" href="/kratos/docs/assets/js/styles.5a9e403c.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/runtime~main.a88784c2.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/main.e8489b26.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/2.0cab358e.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/3.cd1d713f.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/b8d7c5e6.3a4456e2.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/481.fe855e6e.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/f4c568b4.cba9ddfd.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/17896441.3537c629.js" as="script">
<link rel="preload" href="/kratos/docs/assets/js/886942f2.0dfadeec.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a href="https://www.ory.sh/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Home</a><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ory/kratos/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discussions</a><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Slack</a><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/kratos/docs/v0.2/">v0.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/kratos/docs/next/concepts/security">Next</a></li><li><a class="dropdown__link" href="/kratos/docs/concepts/security">v0.6</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.5/concepts/security">v0.5</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.4/concepts/security">v0.4</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.3/concepts/security">v0.3</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/kratos/docs/v0.2/concepts/security">v0.2</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.1/concepts/security">v0.1</a></li><li><a class="dropdown__link" href="/kratos/docs/versions">All versions</a></li></ul></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/" target="_blank" rel="noopener noreferrer" class="menu__link">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://github.com/ory/kratos/discussions" target="_blank" rel="noopener noreferrer" class="menu__link">Discussions</a></li><li class="menu__list-item"><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="menu__link">Slack</a></li><li class="menu__list-item"><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/next/concepts/security">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/concepts/security">v0.6</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.5/concepts/security">v0.5</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.4/concepts/security">v0.4</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.3/concepts/security">v0.3</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/kratos/docs/v0.2/concepts/security">v0.2</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.1/concepts/security">v0.1</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/versions">All versions</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_3h0W"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/kratos/docs/img/logo-kratos.svg" alt="Ory Kratos" class="themedImage_1VuW themedImage--dark_hz6m"></a><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/install">Installation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/concepts/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/concepts/ui-user-interface">User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/concepts/identity-user-model">Identity Data Model</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Identity Credentials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/credentials">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/credentials/username-email-password">Username / Email &amp; Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/concepts/credentials/openid-connect-oidc-oauth2">Social Sign In, OpenID Connect, and OAuth2</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/v0.2/concepts/federation">Federation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kratos/docs/v0.2/concepts/security">Threat Models and Security Profiles</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Self Service</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/index">Before you start reading</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Flows</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/user-login-user-registration">User Login and User Registration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/user-logout">User Logout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/user-settings-profile-management">User Settings and Profile Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/password-reset-account-recovery">Account Recovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/user-facing-errors">User-Facing Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/verify-email-account-activation">Email and Phone Verification and Account Activation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/flows/2fa-mfa-multi-factor-authentication">MFA / 2FA</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Strategies</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/strategies/username-email-password">Username or Email and Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/strategies/openid-connect-social-sign-in-oauth2">Social Sign In with OpenID Connect and OAuth2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/strategies/user-settings-profile">User Profile</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Hooks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/self-service/hooks/index">Hooks</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/guides/zero-trust-iap-proxy-identity-access-proxy">Zero Trust with IAP Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/guides/multi-tenancy-multitenant">Multitenancy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/guides/high-availability-ha">High Availability</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/html-forms">HTML Form Parser</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/reference/api">REST API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Debug &amp; Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/debug/csrf">Common Cookie and CSRF Pitfalls</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SDKs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/sdk/index">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Further Reading</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/v0.2/further-reading/comparison">Comparison</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Hydra</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/hydra" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/hydra/docs" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/hydra" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Oathkeeper</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper/docs" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/oathkeeper" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Keto</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/keto" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/keto/docs" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/keto" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN" tabindex="-1">GitHub</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Ory Kratos <strong>v0.2</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/kratos/docs/concepts/security">latest version</a></strong> (v0.6).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: v0.2</span></div><header><h1 class="docTitle_3a4h">Threat Models and Security Profiles</h1></header><div class="markdown"><p>Running any software that stores personal information exposes the
developer/company to risks. Analyzing which threat agents pose a risk,
understanding the possible motivations for an attack, or why an agent is a
threat, knowing the attack surface, the likelihood, and the impact are important
all aspects of a threat model.</p><p>This documentation can not substitute a thorough and serious threat model, yet
it will provide some guidelines to help configure ORY Kratos in a way that makes
it best suited for any risk assessment.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Please be aware that this chapter is still work in progress. Not all mitigation
strategies have been implemented yet in ORY Kratos!</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="understanding-threats"></a>Understanding Threats<a class="hash-link" href="#understanding-threats" title="Direct link to heading">#</a></h2><p>This section examines several threat vectors in systems that manage identities.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="account-enumeration-attacks"></a>Account Enumeration Attacks<a class="hash-link" href="#account-enumeration-attacks" title="Direct link to heading">#</a></h3><blockquote><p>&quot;Often, web applications reveal when a username exists on system, either as a
consequence of a misconfiguration or as a design decision. For example,
sometimes, when we submit wrong credentials, we receive a message that states
that either the username is present on the system or the provided password is
wrong. The information obtained can be used by an attacker to gain a list of
users on system. This information can be used to attack the web application,
for example, through a brute force or default username/password attack.
Description of the Issue&quot;</p><p><a href="https://wiki.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)" target="_blank" rel="noopener noreferrer">Source</a></p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="scenarios"></a>Scenarios<a class="hash-link" href="#scenarios" title="Direct link to heading">#</a></h4><p>Considering the above, an example would be for example an adult website. A
threat agent wants to blackmail a well known politician by checking if someone
can sign up at that website using the <code>well-known-politician@email.com</code> email.</p><p>If the service responds with
<code>Sorry, that email is already signed up here. Did you try to log in instead?</code>,
the agent is able to proceed with some type of blackmail scheme.</p><p><a href="https://wiki.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)#Black_Box_testing_and_example" target="_blank" rel="noopener noreferrer">OWASP defines several Black-Box tests</a>
that cover Account Enumeration Scenarios.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="mitigation"></a>Mitigation<a class="hash-link" href="#mitigation" title="Direct link to heading">#</a></h4><p>ORY Kratos can be configured to send an out-of-band message to the email used
for login, registration, account recovery, etc.:</p><ul><li>If an application or user tries to sign in using an unknown email address, an
email will be sent to that address reading &quot;You tried to sign in at X but you
do not have an account yet, did you mean to sign up instead?&quot;</li><li>...</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="bruteforce-attacks"></a>Bruteforce Attacks<a class="hash-link" href="#bruteforce-attacks" title="Direct link to heading">#</a></h3><p>Will be addressed in a future release.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="phishing-attacks"></a>Phishing Attacks<a class="hash-link" href="#phishing-attacks" title="Direct link to heading">#</a></h3><p>Will be addressed in a future release.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="social-engineering-attacks"></a>Social Engineering Attacks<a class="hash-link" href="#social-engineering-attacks" title="Direct link to heading">#</a></h3><p>Will be addressed in a future release.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="sms-spoofing-attacks"></a>SMS Spoofing Attacks<a class="hash-link" href="#sms-spoofing-attacks" title="Direct link to heading">#</a></h3><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="choosing-the-right-security-profile-and-configuration"></a>Choosing the right Security Profile and Configuration<a class="hash-link" href="#choosing-the-right-security-profile-and-configuration" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="argon2"></a>Argon2<a class="hash-link" href="#argon2" title="Direct link to heading">#</a></h3><p>ORY Kratos uses Argon2 for password hashing. Argon2 is the official winner of
the PHC 2017. You can tweak the Argon2 configuration in your ORY Kratos
configuration file:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token key atrule">hashers</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">argon2</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token number">1048576</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">iterations</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">parallelism</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">salt_length</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token number">16</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">key_length</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token number">32</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="digital-identity-guidelines"></a>Digital Identity Guidelines<a class="hash-link" href="#digital-identity-guidelines" title="Direct link to heading">#</a></h2><p>There is no one standard to digital identity. ORY Kratos closely follows
emerging frameworks and guidelines such as:
<a href="https://pages.nist.gov/800-63-3/" target="_blank" rel="noopener noreferrer">Digital Identity Guidelines established by the National Institute of Standards and Technology (NIST)</a>
(and a follow-up <a href="https://pages.nist.gov/800-63-3/" target="_blank" rel="noopener noreferrer">FAQ</a>) .</p><p>As ORY Kratos grows, this document will continue to expand and add sections
covering individual security recommendations established by NIST.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="password-policy"></a>Password Policy<a class="hash-link" href="#password-policy" title="Direct link to heading">#</a></h3><p>Almost every service with a login offers some type of registration using a
password. Therefore, there are many strategies floating around, with many of
them implementing terrible and insecure patterns such as:</p><ul><li>Not allowing special characters in passwords.</li><li>Not allowing the use of password managers by disabling the &quot;paste&quot;
functionality in password fields.</li><li>Requiring you to rotate your password every month.</li><li>...</li></ul><p>Troy Hunt has written an
<a href="https://www.troyhunt.com/passwords-evolved-authentication-guidance-for-the-modern-era/" target="_blank" rel="noopener noreferrer">excellent piece on password policies</a>
and why they recently changed and how.</p><p>ORY Kratos implements a password policy that:</p><ul><li>Checks if a password has previously been leaked using the
<a href="https://haveibeenpwned.com/API/v2" target="_blank" rel="noopener noreferrer">HIBP API</a>; and</li><li>Checks if a password is too similar to one of the identifiers (in a future
release <a href="https://github.com/ory/kratos/issues/184" target="_blank" rel="noopener noreferrer">kratos#184</a>).</li></ul><p>This is a rundown of all the practices ORY Kratos implements and why. <strong>Some
things need to be implemented by yourself</strong> as they must be implemented in the
User Interface that interfaces with ORY Kratos. You can find these in section
<a href="#user-interface-guidelines">User Interface Guidelines</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="password-complexity"></a>Password Complexity<a class="hash-link" href="#password-complexity" title="Direct link to heading">#</a></h4><p>This outline and quotes are defined in the
<a href="https://pages.nist.gov/800-63-3/sp800-63b.html" target="_blank" rel="noopener noreferrer">NIST Digital Identity Guidelines - 5.1.1.2 Memorized Secret Verifiers</a>.
ORY Kratos, unless explicitly advertised, implements these guidelines and best
practices.</p><p>Passwords must have a minimum length of 8 characters and all characters
(unicode, ASCII) must be allowed:</p><blockquote><p>Verifiers SHALL require subscriber-chosen memorized secrets to be at least 8
characters in length. Verifiers SHOULD permit subscriber-chosen memorized
secrets at least 64 characters in length. All printing ASCII [RFC 20]
characters as well as the space character SHOULD be acceptable in memorized
secrets. Unicode [ISO/ISC 10646] characters SHOULD be accepted as well. To
make allowances for likely mistyping, verifiers MAY replace multiple
consecutive space characters with a single space character prior to
verification, provided that the result is at least 8 characters in length.
Truncation of the secret SHALL NOT be performed. For purposes of the above
length requirements, each Unicode code point SHALL be counted as a single
character.</p></blockquote><p>Passwords must be checked against a database of compromised secrets such as
<a href="https://haveibeenpwned.com" target="_blank" rel="noopener noreferrer">Have I Been Pwnd</a>:</p><blockquote><p>When processing requests to establish and change memorized secrets, verifiers
SHALL compare the prospective secrets against a list that contains values
known to be commonly-used, expected, or compromised. For example, the list MAY
include, but is not limited to:</p><ul><li>Passwords obtained from previous breach corpuses.</li><li>Dictionary words.</li><li>Repetitive or sequential characters (e.g. ‚Äòaaaaaa‚Äô, ‚Äò1234abcd‚Äô).</li><li>Context-specific words, such as the name of the service, the username, and
derivatives thereof.</li></ul><p>If the chosen secret is found in the list, the CSP or verifier SHALL advise
the subscriber that they need to select a different secret, SHALL provide the
reason for rejection, and SHALL require the subscriber to choose a different
value.</p></blockquote><p>Show the user a password-strength meter (to be implemented, see
<a href="https://github.com/ory/kratos/issues/136" target="_blank" rel="noopener noreferrer">#136</a>):</p><blockquote><p>Verifiers SHOULD offer guidance to the subscriber, such as a password-strength
meter [Meters], to assist the user in choosing a strong memorized secret. This
is particularly important following the rejection of a memorized secret on the
above list as it discourages trivial modification of listed (and likely very
weak) memorized secrets</p></blockquote><p>Do not require mixtures of characters types or prohibiting repeated characters:</p><blockquote><p>Verifiers SHOULD NOT impose other composition rules (e.g., requiring mixtures
of different character types or prohibiting consecutively repeated characters)
for memorized secrets. Verifiers SHOULD NOT require memorized secrets to be
changed arbitrarily (e.g., periodically). However, verifiers SHALL force a
change if there is evidence of compromise of the authenticator.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="user-interface-guidelines"></a>User Interface Guidelines<a class="hash-link" href="#user-interface-guidelines" title="Direct link to heading">#</a></h4><p>These best practices need to be implemented in your User Interface and can not
be handled by ORY Kratos. All ORY-built reference and demo applications
implement these best practices:</p><p>Allow pasting of passwords:</p><blockquote><p>Verifiers SHOULD permit claimants to use ‚Äúpaste‚Äù functionality when entering a
memorized secret. This facilitates the use of password managers, which are
widely used and in many cases increase the likelihood that users will choose
stronger memorized secrets.</p></blockquote><p>Allow the user to show the secret in the UI:</p><blockquote><p>In order to assist the claimant in successfully entering a memorized secret,
the verifier SHOULD offer an option to display the secret ‚Äî rather than a
series of dots or asterisks ‚Äî until it is entered. This allows the claimant to
verify their entry if they are in a location where their screen is unlikely to
be observed. The verifier MAY also permit the user‚Äôs device to display
individual entered characters for a short time after each character is typed
to verify correct entry. This is particularly applicable on mobile devices.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="password-hints"></a>Password Hints<a class="hash-link" href="#password-hints" title="Direct link to heading">#</a></h4><blockquote><p>Memorized secret verifiers SHALL NOT permit the subscriber to store a ‚Äúhint‚Äù
that is accessible to an unauthenticated claimant.</p><p><a href="https://pages.nist.gov/800-63-3/sp800-63b.html" target="_blank" rel="noopener noreferrer">NIST Digital Identity Guidelines - 5.1.1.2 Memorized Secret Verifiers</a></p></blockquote></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ory/kratos/edit/master/docs/versioned_docs/version-v0.2/concepts/security.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-06-05T14:36:38.000Z" class="lastUpdatedDate_1WI_">6/5/2020</time> by <strong>Bengt Hagemeister</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kratos/docs/v0.2/concepts/federation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Federation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kratos/docs/v0.2/self-service/index"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Before you start reading ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#understanding-threats" class="table-of-contents__link">Understanding Threats</a><ul><li><a href="#account-enumeration-attacks" class="table-of-contents__link">Account Enumeration Attacks</a></li><li><a href="#bruteforce-attacks" class="table-of-contents__link">Bruteforce Attacks</a></li><li><a href="#phishing-attacks" class="table-of-contents__link">Phishing Attacks</a></li><li><a href="#social-engineering-attacks" class="table-of-contents__link">Social Engineering Attacks</a></li><li><a href="#sms-spoofing-attacks" class="table-of-contents__link">SMS Spoofing Attacks</a></li></ul></li><li><a href="#choosing-the-right-security-profile-and-configuration" class="table-of-contents__link">Choosing the right Security Profile and Configuration</a><ul><li><a href="#argon2" class="table-of-contents__link">Argon2</a></li></ul></li><li><a href="#digital-identity-guidelines" class="table-of-contents__link">Digital Identity Guidelines</a><ul><li><a href="#password-policy" class="table-of-contents__link">Password Policy</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.ory.sh/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.ory.sh/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://www.ory.sh/tos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div>Copyright ¬© 2021 ORY GmbH</div></div></div></footer></div>
<script src="/kratos/docs/assets/js/styles.5a9e403c.js"></script>
<script src="/kratos/docs/assets/js/runtime~main.a88784c2.js"></script>
<script src="/kratos/docs/assets/js/main.e8489b26.js"></script>
<script src="/kratos/docs/assets/js/2.0cab358e.js"></script>
<script src="/kratos/docs/assets/js/3.cd1d713f.js"></script>
<script src="/kratos/docs/assets/js/b8d7c5e6.3a4456e2.js"></script>
<script src="/kratos/docs/assets/js/481.fe855e6e.js"></script>
<script src="/kratos/docs/assets/js/f4c568b4.cba9ddfd.js"></script>
<script src="/kratos/docs/assets/js/17896441.3537c629.js"></script>
<script src="/kratos/docs/assets/js/886942f2.0dfadeec.js"></script>
<noscript><p><img src="//sqa-web.ory.sh/np.php?idsite=2&amp;rec=1" style="border:0;" alt=""></p></noscript></body>
</html>